<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Detailed Description of the state machine" href="details_state_machine.html" /><link rel="prev" title="Running a new pose estimator with the grasping pipeline" href="run_new_pose_estimator.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>Overview of the statemachine - Grasping Pipeline 0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=10e673fd" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Grasping Pipeline 0.1 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Grasping Pipeline 0.1 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="startup.html">Starting the grasping pipeline</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_new_pose_estimator.html">Running a new pose estimator with the grasping pipeline</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Overview of the statemachine</a></li>
<li class="toctree-l1"><a class="reference internal" href="details_state_machine.html">Detailed Description of the state machine</a></li>
<li class="toctree-l1"><a class="reference internal" href="ideas.html">Some ideas for the documentation:</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="overview-of-the-statemachine">
<h1>Overview of the statemachine<a class="headerlink" href="#overview-of-the-statemachine" title="Permalink to this heading">#</a></h1>
<p>This page gives an overview of the statemachine and its components. It is intended to give a high-level understanding of the statemachine.
For a more detailed description of the statemachine, see <a class="reference internal" href="details_state_machine.html"><span class="doc">Detailed Description of the state machine</span></a>.</p>
<p>The statemachine is a finite state machine that is used to control the behavior of the robot. It is implemented in python with the <a class="reference external" href="http://wiki.ros.org/smach">smach</a> library.</p>
<p>It currently consists of 5 main components:</p>
<ul class="simple">
<li><p>FindGrasp: This component is responsible for calling the pose estimator and finding grasp points for the robot.</p></li>
<li><p>ExecuteGrasp: This component is responsible for executing the grasp(s) that was found by the FindGrasp component. It also updates the collision environment.</p></li>
<li><p>RobotSetup: This component is responsible for moving the robot and all of its joints into a predefined position.</p></li>
<li><p>Placement: This component is responsible for placing the grasped, known object to its appointed location.</p></li>
<li><p>Handover: This component is responsible for handing over the grasped object to a human.</p></li>
</ul>
<p>Each of these components is implemented as a state machine (and therefore consists of multiple states), and the components are all combined into a single, big state machine that controls the behavior of the robot.</p>
<section id="findgrasp">
<h2>FindGrasp<a class="headerlink" href="#findgrasp" title="Permalink to this heading">#</a></h2>
<p>The FindGrasp component calls the pose estimator to get the estimated poses for each of the objects detected in the scene.</p>
<p>In the case of known object pose estimation, it uses the name to lookup the grasp annotations for that object. In the case of unknown object pose estimation an unknown object grasp pose estimator is called to get the grasp pose.</p>
<section id="outcomes">
<h3>Outcomes<a class="headerlink" href="#outcomes" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>succeeded</strong>: The grasp was found successfully.</p></li>
<li><p><strong>aborted</strong>: No object or grasp was found.</p></li>
<li><p><strong>preempted</strong>: This outcome is currently not used.</p></li>
</ul>
</section>
<section id="inputs">
<h3>Inputs<a class="headerlink" href="#inputs" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>object_to_grasp (string)</strong>: The name of the object to grasp. If no name is given (=empty string), the closest object is grasped instead.</p></li>
</ul>
</section>
<section id="outputs">
<h3>Outputs<a class="headerlink" href="#outputs" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>grasp_poses (list of geometry_msgs/PoseStamped)</strong>: A list of grasp poses for the object that should be grasped.</p></li>
<li><p><strong>grasp_object_bb (grasping_pipeline_msgs/BoundingBox3DStamped)</strong>: The bounding box of the grasped object. This is used for collision checking when placing the object.</p></li>
<li><p><strong>grasp_object_name (string)</strong>: The name of the grasped object. This name is needed for placement to know where to place the object, as each object has a predefined placement area.</p></li>
</ul>
</section>
</section>
<section id="executegrasp">
<h2>ExecuteGrasp<a class="headerlink" href="#executegrasp" title="Permalink to this heading">#</a></h2>
<p>The ExecuteGrasp component is responsible for executing the grasp that was found by the FindGrasp component.</p>
<p>First, the table plane that the object is resting on is detected. Then, the collision environment is updated with the <cite>grasp_object_bb</cite> and the detected table. The <cite>grasp_object_bb</cite> is needed if placement should be done after the grasping. The table is needed to prevent the robot from colliding with the table.</p>
<p>Afterwards, the robot moves to the grasp pose and executes the grasp. Simultaneously, it records the transformation between the robot’s end-effector and the object’s bottom plane. This transformation is needed for placement to ensure that the object is placed in a manner that maintains the objects original orientation (i.e. the bottom side of the object when it was grasped, will also be the bottom side of the object after it is placed).</p>
<p>If the grasp failed, the component returns a ‘failed_to_grasp’ outcome.</p>
<p>If the grasp was succesful, the robot retreats from the table, moves the joints into a neutral position and drives to a predefined position in a way that should prevent the robot and its arm from coliding with any object (especially the table). Afterwards, ‘execute_grasp_success’ is returned.</p>
<section id="id1">
<h3>Outcomes<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>failed_to_grasp</strong>: Execution of all provided grasp poses failed.</p></li>
<li><p><strong>execute_grasp_success</strong>: The grasp was executed successfully.</p></li>
</ul>
</section>
<section id="id2">
<h3>Inputs<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>grasp_poses (list of PoseStamped)</strong>: A list of grasp poses for the object that should be grasped. The grasp_poses are processed iteratively until the grasp was succesful or no further grasp pose remains.</p></li>
<li><p><strong>grasp_object_bb (BoundingBox3DStamped)</strong>: The bounding box of the grasped object. This is used for collision checking when placing the object.</p></li>
</ul>
</section>
<section id="id3">
<h3>Outputs<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>placement_surface_to_wrist (geometry_msgs/Transform)</strong>: The transformation between the robot’s end-effector and the object’s bottom plane. This transformation is needed for placement to ensure that the object is placed in a manner that maintains the objects original orientation.</p></li>
</ul>
</section>
</section>
<section id="robotsetup">
<h2>RobotSetup<a class="headerlink" href="#robotsetup" title="Permalink to this heading">#</a></h2>
<p>This component is responsible for moving the robot and all of its joints into a predefined position. This is needed to ensure that the robot is in a known state before any other state is executed.</p>
<p>More specifically, the robot moves in front of the table, the arm is moved in a way so that it does not cover parts of the camera, the gripper is opened and the head is moved so that it gazes at the table plane.</p>
<section id="id4">
<h3>Outcomes<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>setup_succeeded</strong>: The robot and its joints were moved into the predefined position successfully.</p></li>
</ul>
</section>
<section id="id5">
<h3>Inputs<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h3>
<p>None</p>
</section>
<section id="id6">
<h3>Outputs<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h3>
<p>None</p>
</section>
</section>
<section id="placement">
<h2>Placement<a class="headerlink" href="#placement" title="Permalink to this heading">#</a></h2>
</section>
<section id="handover">
<h2>Handover<a class="headerlink" href="#handover" title="Permalink to this heading">#</a></h2>
<p>The Handover component is responsible for handing over the grasped object to a human. The robot’s arm is stretched out to make it as comfortable as possible for adults to take the object. The torque sensor in the robot’s wrist is used to detect when the object is taken by the human. When the torque sensor detects a force above a certain threshold, the robot releases the object and returns ‘succeeded’.</p>
<section id="id7">
<h3>Outcomes<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>succeeded</strong>: The object was handed over successfully.</p></li>
<li><p><strong>aborted</strong>: This outcome is currently not used.</p></li>
<li><p><strong>preempted</strong>: This outcome is currently not used.</p></li>
</ul>
</section>
<section id="id8">
<h3>Inputs<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>force_thresh (float), optional</strong>: The threshold for the torque sensor to detect when the object is taken by the human. A default value is used if no threshold is passed or the passed threshold is &lt;0.</p></li>
</ul>
</section>
<section id="id9">
<h3>Outputs<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h3>
<p>None</p>
</section>
</section>
<section id="other-states">
<h2>Other states<a class="headerlink" href="#other-states" title="Permalink to this heading">#</a></h2>
<p>Some states are currently not used in the statemachine, but are still implemented. These states are:</p>
<ul class="simple">
<li></li>
<li></li>
</ul>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="details_state_machine.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Detailed Description of the state machine</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="run_new_pose_estimator.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Running a new pose estimator with the grasping pipeline</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, Alexander Haberl
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Overview of the statemachine</a><ul>
<li><a class="reference internal" href="#findgrasp">FindGrasp</a><ul>
<li><a class="reference internal" href="#outcomes">Outcomes</a></li>
<li><a class="reference internal" href="#inputs">Inputs</a></li>
<li><a class="reference internal" href="#outputs">Outputs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#executegrasp">ExecuteGrasp</a><ul>
<li><a class="reference internal" href="#id1">Outcomes</a></li>
<li><a class="reference internal" href="#id2">Inputs</a></li>
<li><a class="reference internal" href="#id3">Outputs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#robotsetup">RobotSetup</a><ul>
<li><a class="reference internal" href="#id4">Outcomes</a></li>
<li><a class="reference internal" href="#id5">Inputs</a></li>
<li><a class="reference internal" href="#id6">Outputs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#placement">Placement</a></li>
<li><a class="reference internal" href="#handover">Handover</a><ul>
<li><a class="reference internal" href="#id7">Outcomes</a></li>
<li><a class="reference internal" href="#id8">Inputs</a></li>
<li><a class="reference internal" href="#id9">Outputs</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other-states">Other states</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js?v=e031e9a9"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=35a8b989"></script>
    </body>
</html>